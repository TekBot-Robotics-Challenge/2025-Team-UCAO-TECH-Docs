<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Test 2 - Boîte noire | UCAO-TECH</title>
  <link rel="icon" href="https://ucaotech.com/wp-content/uploads/2024/10/UCAO-TECH-1.png" type="image/png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet" />
  
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      background-color: #020c1b;
      color: #e6f1ff;
      font-family: 'Roboto', sans-serif;
      padding: 100px 2rem 2rem 2rem;
    }
    h2, h3, h4, h5, h6 {
      color: #00f7ff;
      font-family: 'Orbitron', sans-serif;
      margin-top: 1rem;
    }
    header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 1000;
      background-color: rgba(2, 12, 27, 0.9);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(0, 209, 255, 0.2);
    }
    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem 2rem;
    }
    .logo {
      display: flex;
      align-items: center;
      gap: 15px;
      color: white;
      text-decoration: none;
      font-size: 1.5rem;
      font-weight: 700;
    }
    .logo img {
      height: 50px;
      transition: transform 0.5s ease;
      cursor: pointer;
    }
    .logo:hover img {
      transform: rotate(360deg);
    }
    .logo span {
      color: #00d1ff;
    }
    .nav-links {
      display: flex;
      gap: 1.5rem;
    }
    .nav-links a {
      color: rgba(230, 241, 255, 0.8);
      text-decoration: none;
      font-weight: 500;
      font-size: 0.82rem;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      padding: 0.5rem 0.8rem;
      position: relative;
      transition: all 0.3s ease;
    }
    .nav-links a::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 0;
      height: 2px;
      background: linear-gradient(90deg, #00d1ff, #9452ff);
      transition: width 0.3s ease;
    }
    .nav-links a:hover {
      color: #00d1ff;
    }
    .nav-links a:hover::before,
    .nav-links a.active::before {
      width: 100%;
    }
    .nav-links a.active {
      color: #00d1ff;
    }
    .section {
      background-color: rgba(10, 25, 47, 0.4);
      padding: 2rem;
      border-radius: 10px;
      margin-top: 2rem;
      max-width: 1000px;
      margin-left: auto;
      margin-right: auto;
    }
    .section p {
      margin-top: 1rem;
      line-height: 1.6;
    }
    ul, ol {
      margin-left: 1.5rem;
      margin-top: 1rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }
    th, td {
      padding: 0.5rem;
      border: 1px solid #00d1ff;
    }
    pre {
      background-color: #0a192f;
      padding: 1rem;
      overflow-x: auto;
      border-left: 4px solid #00f7ff;
      margin-top: 1rem;
    }
    code {
      font-family: monospace;
      color: #00f7ff;
    }
    iframe {
      margin-top: 1rem;
      border: 1px solid #00d1ff;
    }
    .toc {
      background-color: #081a2b;
      padding: 1rem;
      margin: 2rem 0;
      border-left: 4px solid #00f7ff;
    }
    .toc h4 {
      margin-top: 0;
    }
    .toc ul {
      list-style: none;
      padding-left: 0;
    }
    .toc ul li {
      margin: 0.5rem 0;
    }
    .toc ul li a {
      color: #00d1ff;
      text-decoration: none;
    }
    .toc ul li a:hover {
      text-decoration: underline;
    }

    .component-card {
      display: flex;
      flex-wrap: wrap;
      gap: 2rem;
      background-color: rgba(2, 12, 27, 0.6);
      padding: 1.5rem;
      border-radius: 10px;
      margin: 2rem auto;
      max-width: 900px;
      align-items: center;
      border-left: 4px solid #00f7ff;
      box-shadow: 0 0 10px rgba(0, 209, 255, 0.1);
    }

    .component-img {
      width: 100%;
      max-width: 220px;
      height: auto;
      border-radius: 8px;
      border: 1px solid #00d1ff;
      margin: 0 auto;
      display: block;
      cursor: pointer; /* pour la lightbox */
      transition: transform 0.3s ease;
    }
    .component-img:hover {
      transform: scale(1.05);
    }

    /* Si plusieurs images dans un même composant */
    .component-card .component-img + .component-img {
      margin-top: 1rem;
    }

    /* Spécial pour les images empilées */
    .component-card img:not(:first-child) {
      margin-top: 1rem;
    }

    .pcb-section img,
    .schematic-section img {
      max-width: 400px;
      width: 100%;
      height: auto;
      cursor: pointer;
      border-radius: 6px;
      border: 1px solid #00d1ff;
      display: block;
      margin: 0.8rem auto;
      transition: transform 0.3s ease;
    }
    .pcb-section img:hover,
    .schematic-section img:hover {
      transform: scale(1.03);
    }

    @media (max-width: 768px) {
      .component-card {
        flex-direction: column;
        text-align: center;
      }
      .component-img, .component-desc {
        flex: 1 1 100%;
      }
    }

    /* Lightbox styles */
    #lightbox-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.85);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 2000;
      cursor: zoom-out;
    }
    #lightbox-overlay img {
      max-width: 90vw;
      max-height: 90vh;
      box-shadow: 0 0 20px #00d1ff;
      border-radius: 10px;
    }
    .download-btn {
  display: inline-block;
  padding: 12px 25px;
  background: linear-gradient(90deg, #00d1ff, #9452ff);
  color: #fff;
  font-weight: 600;
  text-decoration: none;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 209, 255, 0.5);
  transition: background 0.3s ease, box-shadow 0.3s ease;
  font-size: 1rem;
  margin-top: 1rem;
  user-select: none;
}
.download-btn:hover,
.download-btn:focus {
  background: linear-gradient(90deg, #9452ff, #00d1ff);
  box-shadow: 0 6px 16px rgba(148, 82, 255, 0.7);
  outline: none;
}
.download-btn i {
  margin-right: 8px;
  vertical-align: middle;
}

  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <nav class="navbar">
      <a href="https://tekbot-robotics-challenge.github.io/2025-Team-UCAO-TECH-Docs" class="logo">
        <img src="https://ucaotech.com/wp-content/uploads/2024/10/UCAO-TECH-1.png" alt="UCAO-TECH Logo" />
        <span>UCAO-TECH</span>
      </a>
      <ul class="nav-links">
        <li><a href="https://tekbot-robotics-challenge.github.io/2025-Team-UCAO-TECH-Docs">Accueil</a></li>
        <li><a href="https://tekbot-robotics-challenge.github.io/2025-Team-UCAO-TECH-Docs/#a-propos">À propos</a></li>
        <li><a href="https://tekbot-robotics-challenge.github.io/2025-Team-UCAO-TECH-Docs/#equipe">Équipe</a></li>
        <li><a href="https://tekbot-robotics-challenge.github.io/2025-Team-UCAO-TECH-Docs/#contact">Contact</a></li>
        <li><a href="https://tekbot-robotics-challenge.github.io/2025-Team-UCAO-TECH-Docs/#documentation">Documentation</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <section class="section-doc">
      <h2>Test 2 : Boîte Noire - Communication et Contrôle</h2>
      <h3>Durée : 1 semaine</h3>

      <h4>Introduction</h4>
      <p>Dans les secteurs de l'aéronautique, de l'automobile ou du ferroviaire, les boîtes noires sont essentielles pour l'enregistrement des données de fonctionnement. Inspirés de ces systèmes, nous avons conçu un dispositif capable d'enregistrer et de transmettre en temps réel les données de mouvement d'un robot grâce à un capteur MPU6050 (accéléromètre + gyroscope) intégré dans une boîte cubique.</p>

      <h4>Objectifs du test</h4>
      <ul>
        <li>Mettre en œuvre un système d'acquisition de données inertielle (MPU6050)</li>
        <li>Transmettre les données via un bus I2C vers une station de contrôle</li>
        <li>Afficher les données en temps réel sur un écran LCD</li>
        <li>Utiliser des microcontrôleurs ATmega328P sans carte Arduino</li>
        <li>Documenter la conception du circuit imprimé (PCB) et assurer une présentation professionnelle</li>
      </ul>

      <h4>Liste des composants utilisés</h4>
      <div class="component-grid">
        <!-- ATmega328P -->
        <div class="component-card">
          <img src="Images/ATMEGA328P.jpg" alt="ATmega328P" class="component-img" />
          <div class="component-desc">
            <h5>2 × ATmega328P</h5>
            <p>Cœur du système, ces microcontrôleurs 8-bit gèrent :</p>
            <ul>
              <li>La communication I2C entre modules</li>
              <li>Le traitement des données du capteur</li>
              <li>L'affichage sur l'écran LCD</li>
            </ul>
            <p>Caractéristiques : 32KB Flash, 2KB SRAM, 16MHz</p>
          </div>
        </div>

        <!-- MPU6050 -->
        <div class="component-card">
          <div class="component-desc">
            <h5>1 × Module MPU6050</h5>
            <p>Capteur 6 axes (gyroscope + accéléromètre) utilisé pour :</p>
            <ul>
              <li>Détection de l'orientation spatiale</li>
              <li>Mesure des mouvements brusques</li>
              <li>Référence à la gravité terrestre</li>
            </ul>
            <p>Communication via I2C (adresse 0x68)</p>
          </div>
          <img src="../Test1/Images/GY-521.png" alt="MPU6050" class="component-img" />
        </div>

        <!-- LCD 16x2 -->
        <div class="component-card">
          <div class="component-desc">
            <h5>1 × Écran LCD 16x2</h5>
            <p>Interface de visualisation des données :</p>
            <ul>
              <li>Affiche les données en temps réel</li>
              <li>Contrôlé via interface I2C</li>
              <li>Adresse typique : 0x27 ou 0x3F</li>
            </ul>
            <p>Consommation : ~1mA</p>
          </div>
          <img src="Images/16x2-lcd.webp" alt="LCD 16x2" class="component-img" />
        </div>

        <!-- Régulateur 5V -->
        <div class="component-card">
          <div class="component-desc">
            <h5>1 × Régulateur de tension 5V</h5>
            <p>Stabilise l'alimentation électrique :</p>
            <ul>
              <li>Protège les composants sensibles</li>
              <li>Type : LM7805</li>
            </ul>
            <p>Courant max : 1A (avec dissipateur)</p>
          </div>
          <img src="Images/regulateurdetension5v.jpg" alt="Régulateur 5V" class="component-img" />
        </div>

        <!-- Composants passifs -->
        <div class="component-card">
          <div class="component-desc">
            <h5>Résistances, condensateurs, quartz 16MHz</h5>
            <p>Éléments essentiels au fonctionnement :</p>
            <ul>
              <li>Résistances 10kΩ et 220Ω</li>
              <li>Condensateurs de découplage (100nF)</li>
              <li>Quartz pour l'horloge du microcontrôleur</li>
            </ul>
            <p>Précision requise : ±5%</p>
          </div>
          <div style="display: flex; gap: 1rem; flex-wrap: wrap; justify-content: center;">
            <img src="Images/resistance220.jpg" class="component-img" style="max-width: 120px;" alt="Résistance 220Ω"/>
            <img src="Images/CONDENSATEUR100nF.jpg" class="component-img" style="max-width: 120px;" alt="Condensateur 100nF"/>
            <img src="Images/quartz16mhZ.webp" class="component-img" style="max-width: 120px;" alt="Quartz 16MHz"/>
          </div>
        </div>
      </div>

      <h4>Architecture du système</h4>
      <p>Le système est réparti en deux modules :</p>
      <ul>
        <li><strong>Module capteur (la boîte noire)</strong> : contient l'ATmega328P maître I2C et le MPU6050</li>
        <li><strong>Station de contrôle</strong> : contient l'ATmega328P esclave I2C et l'écran LCD</li>
      </ul>

      <h4>Schémas électroniques (réalisés sur KiCad)</h4>
      <p>Les circuits ont été conçus avec KiCad pour chaque sous-système du projet.</p>

      <div class="schematic-gallery">
        <div class="schematic-section">
          <h6>Schéma de l'alimentation</h6>
          <img src="Images/IMG_Circuit_Alimentation.PNG" alt="Schéma alimentation" />
        </div>

        <div class="schematic-section">
          <h6>Schéma de la boîte noire</h6>
          <img src="Images/img_Circuit_Boite_Noire.PNG" alt="Schéma boîte noire" />
        </div>

        <div class="schematic-section">
          <h6>Schéma de la station de contrôle</h6>
          <img src="Images/img_Circuit_Station.PNG" alt="Schéma station de contrôle" />
        </div>
      </div>

      <h4>Circuit imprimé</h4>
      <p>Support physique du circuit : PCB personnalisé pour chaque module : alimentation, boîte noire et station de contrôle</p>

      <div class="pcb-gallery">
        <!-- Carte alimentation -->
        <div class="pcb-section">
          <h6>Carte d'alimentation</h6>
          <img src="Images/img_PCBAlimentation.PNG" alt="Carte alimentation 2D" />
          <img src="Images/img_PCB_3D_Alimentation.PNG" alt="Carte alimentation 3D" />
        </div>

        <!-- Carte boîte noire -->
        <div class="pcb-section">
          <h6>Carte de la boîte noire</h6>
          <img src="Images/img_PCB_2D_boite_noire.PNG" alt="Carte boîte noire 2D" />
          <img src="Images/img_PCB_3D_boite_noire.PNG" alt="Carte boîte noire 3D" />
        </div>

        <!-- Carte station de contrôle -->
        <div class="pcb-section">
          <h6>Carte de la station de contrôle</h6>
          <img src="Images/imgSC_PCB.PNG" alt="Carte station de contrôle 2D" />
          <img src="Images/imgSC_3D_front.PNG" alt="Carte station de contrôle 3D" />
        </div>
      </div>
<h4>Téléchargement des fichiers KiCad</h4>
<p>Téléchargez ici tous les fichiers sources KiCad regroupant les schémas et PCB du projet :</p>
<a href="Schemas/Circuit_electronique_test2.rar" download class="download-btn" aria-label="Télécharger les fichiers KiCad">
  <i class="fa fa-download"></i> Télécharger le dossier KiCad complet (RAR)
</a>

      <h4>Codes</h4>
      <h5>Côté "boîte noire" (maître I2C, avec MPU6050</h5>
      <pre><code>// MPU6050 + ATmega328P - Maître I2C
#include <util/delay.h>         // Bibliothèque pour les délais
#include "i2c_master.h"         // Fichier pour fonctions I2C en maître
#include "mpu6050.h"            // Fichier pour gérer le capteur MPU6050

void main(void) {
    int16_t ax, ay, az, gx, gy, gz; // Variables pour stocker les données d'accéléromètre et gyroscope

    i2c_init();         // Initialisation du bus I2C en mode maître
    mpu6050_init();     // Initialisation du capteur MPU6050

    while (1) {
        // Lecture des données de l'accéléromètre
        mpu6050_read_accel(&ax, &ay, &az);

        // Lecture des données du gyroscope (non utilisées ici mais disponibles)
        mpu6050_read_gyro(&gx, &gy, &gz);

        // Démarre la communication I2C avec l'esclave à l'adresse 0x10
        i2c_start(0x10);

        // Envoi des données de l’accéléromètre Ax, Ay, Az sous forme de 16 bits (haut puis bas)
        i2c_write(ax >> 8);     // Octet de poids fort de ax
        i2c_write(ax & 0xFF);   // Octet de poids faible de ax
        i2c_write(ay >> 8);
        i2c_write(ay & 0xFF);
        i2c_write(az >> 8);
        i2c_write(az & 0xFF);

        i2c_stop();             // Fin de transmission I2C

        _delay_ms(500);        // Attente de 500 ms avant la prochaine lecture
    }
}
</code></pre>

      <h5>Côté "station de contrôle" (esclave I2C + LCD 4 bits)</h5>
      <pre><code>// ATmega328P - Esclave I2C + Afficheur LCD 4 bits
#include "i2c_slave.h"     // Bibliothèque I2C en mode esclave
#include "lcd.h"           // Bibliothèque de gestion d’afficheur LCD (mode 4 bits)

volatile uint8_t buffer[6];   // Tableau pour stocker les 6 octets reçus (ax, ay, az)
volatile uint8_t index = 0;   // Index pour le tableau de réception

// Fonction appelée à chaque octet reçu via I2C
void receive_event(uint8_t data) {
    buffer[index++] = data;   // Stockage de l’octet reçu

    if (index >= 6) {         // Une fois 6 octets reçus (2 par axe)
        lcd_gotoxy(0, 0);     // Se positionner ligne 1, colonne 0
        lcd_printf("Ax:%d", (buffer[0] << 8) | buffer[1]); // Affiche ax

        lcd_gotoxy(0, 1);     // Se positionner ligne 2, colonne 0
        lcd_printf("Ay:%d", (buffer[2] << 8) | buffer[3]); // Affiche ay

        index = 0;            // Réinitialise l’index pour la prochaine série
    }
}

int main(void) {
    lcd_init();             // Initialisation de l'afficheur LCD
    lcd_clear();            // Efface l'afficheur

    i2c_slave_init(0x10);   // Initialise le microcontrôleur comme esclave I2C avec l’adresse 0x10
    i2c_set_receive_callback(receive_event);  // Définition de la fonction à appeler à chaque octet reçu

    while (1) {
        // Boucle vide : tout est géré via interruptions et fonctions de rappel (callback)
    }
}
</code></pre>

      <h4>Contraintes et recommandations</h4>
      <ul>
        <li>Ne pas utiliser de carte Arduino ou breadboard dans la version finale</li>
        <li>Boîte cubique de 7 cm avec ouverture sur le dessus si opaque</li>
        <li>Câblage propre et composants fixés solidement</li>
        <li>Station de contrôle séparée avec écran bien lisible</li>
      </ul>

      <h4>Vidéo de démonstration</h4>
      <div class="video-container">
        <video controls>
          <source src="#" type="video/mp4">
          Votre navigateur ne supporte pas la lecture de cette vidéo.
        </video>
          
      </div>

      <h4>Critères d'évaluation</h4>
      <table>
        <tr><th>Critère</th><th>Détails</th><th>Points</th></tr>
        <tr><td>Circuiterie</td><td>Qualité du schéma, soudure, alimentation, présentation du circuit</td><td>25</td></tr>
        <tr><td>Code</td><td>Lisibilité, commentaires, logique du code</td><td>25</td></tr>
        <tr><td>Réalisation physique</td><td>Esthétique de la boîte et du poste de contrôle</td><td>10</td></tr>
        <tr><td>Fonctionnement</td><td>Qualité de la démonstration du système</td><td>25</td></tr>
        <tr><td>Documentation</td><td>Structure, clarté, rigueur technique</td><td>10</td></tr>
        <tr><td>Présentation orale</td><td>Slides, expression orale, réponse aux questions</td><td>5</td></tr>
      </table>

      <h4>Conclusion</h4>
      <p>Ce test a permis de mettre en œuvre un système embarqué capable de mesurer et transmettre des données inertielle en temps réel. Il s'inscrit dans une logique de fiabilité, de rigueur technique et d'intégration dans une solution robotique autonome.</p>
    </section>
  </main>
</body>
</html>
