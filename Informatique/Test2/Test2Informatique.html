<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Documentation Complète ROS2 - sensor_data_evaluation | UCAO-TECH</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet" />
  <style>
    /* Header */
    header {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        z-index: 1000;
        background-color: rgba(2, 12, 27, 0.9);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(0, 209, 255, 0.2);
        transition: all 0.3s ease;
    }
    
    .navbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        max-width: 1400px;
        margin: 0 auto;
        padding: 1rem 2rem;
    }
    
    .logo {
        display: flex;
        align-items: center;
        gap: 15px;
        color: white;
        text-decoration: none;
        font-size: 1.5rem;
        font-weight: 700;
    }
    
    .logo img {
        height: 50px;
        transition: transform 0.5s ease;
    }
    
    .logo:hover img {
        transform: rotate(360deg);
    }
    
    .logo span {
        color: var(--secondary);
    }
    
    .nav-links {
        display: flex;
        gap: 1.5rem;
    }
    
    .nav-links a {
        color: rgba(230, 241, 255, 0.8);
        text-decoration: none;
        font-weight: 500;
        font-size: 0.82rem;
        text-transform: uppercase;
        letter-spacing: 1.2px;
        padding: 0.5rem 0.8rem;
        position: relative;
        transition: all 0.3s ease;
    }
    
    .nav-links a::before {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 0;
        height: 2px;
        background: linear-gradient(90deg, var(--secondary), var(--cyber-purple));
        transition: width 0.3s ease;
    }
    
    .nav-links a:hover {
        color: var(--cyber-blue);
    }
    
    .nav-links a:hover::before {
        width: 100%;
    }
    
    .nav-links a.active {
        color: var(--cyber-blue);
    }
    
    .nav-links a.active::before {
        width: 100%;
    }
    
    .mobile-menu-btn {
        display: none;
        background: none;
        border: none;
        color: white;
        font-size: 1.5rem;
        cursor: pointer;
        z-index: 1001;
    }
    
    /* Main Content */
    body {
      background-color: #020c1b;
      color: #e6f1ff;
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 100px 1rem 1rem 1rem;
    }

    .section #informatique {
      margin-top: 5em;
    }
    
    h2.cyber-title, h2, h3, h4, h5 {
      color: #00f7ff;
      font-family: 'Orbitron', sans-serif;
    }
    
    img {
      max-width: 100%;
      border: 1px solid #00d1ff;
      margin: 1rem 0;
    }
    
    .section-doc {
      background-color: rgba(10, 25, 47, 0.4);
      padding: 2rem;
      border-radius: 10px;
      margin-top: 2rem;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }
    
    th, td {
      padding: 0.5rem;
      border: 1px solid #00d1ff;
    }
    
    a {
      color: #00d1ff;
      text-decoration: none;
    }
    
    a:hover {
      color: #9452ff;
      text-decoration: underline;
    }
    
    pre {
      background-color: #0a192f;
      padding: 1rem;
      overflow-x: auto;
      border-left: 4px solid #00f7ff;
    }
    
    code {
      font-family: monospace;
      color: #00f7ff;
    }
    
    .feature-card ul {
      list-style: none;
      padding-left: 0;
    }
    
    .feature-card ul li {
      padding: 0.25rem 0;
    }
    
    .toc {
      background-color: #081a2b;
      padding: 1rem;
      margin: 2rem 0;
      border-left: 4px solid #00f7ff;
    }
    
    .toc h4 {
      margin-top: 0;
    }
    
    .toc ul {
      list-style: none;
      padding-left: 0;
    }
    
    .toc ul li {
      margin: 0.5rem 0;
    }
    
    .divider {
      border-top: 2px dashed #00d1ff;
      margin: 2rem 0;
    }
    
    /* Specific styles from original doc */
    ul, ol { margin-left: 1.5rem; }
    pre code { display: block; padding: 1rem; background: #0a192f; border-left: 4px solid #00f7ff; overflow-x: auto; font-family: monospace; }
    .tip { background: #0a192f; border-left: 4px solid #00f7ff; padding: 1em; margin: 1em 0; border-radius: 6px; }
    .warn { background: #fff3e0; border-left: 4px solid #ffa726; color: #222; padding: 1em; margin: 1em 0; border-radius: 6px; }
  </style>
</head>
<body>

  <!-- Header -->
  <header>
    <nav class="navbar">
      <a href="https://tekbot-robotics-challenge.github.io/2025-Team-UCAO-TECH-Docs" class="logo">
        <img src="https://ucaotech.com/wp-content/uploads/2024/10/UCAO-TECH-1.png" alt="UCAO-TECH Logo">
        <span>UCAO-TECH</span>
      </a>
      <ul class="nav-links">
        <li><a href="https://tekbot-robotics-challenge.github.io/2025-Team-UCAO-TECH-Docs">Accueil</a></li>
        <li><a href="https://tekbot-robotics-challenge.github.io/2025-Team-UCAO-TECH-Docs/#a-propos">À propos</a></li>
        <li><a href="https://tekbot-robotics-challenge.github.io/2025-Team-UCAO-TECH-Docs/#equipe">Équipe</a></li>
        <li><a href="https://tekbot-robotics-challenge.github.io/2025-Team-UCAO-TECH-Docs/#contact">Contact</a></li>
        <li><a href="https://tekbot-robotics-challenge.github.io/2025-Team-UCAO-TECH-Docs/#documentation">Documentation</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <section class="section" id="informatique">
      <div class="section-container">
        <div class="section-title">
          <h2 class="cyber-title">Documentation complète : ROS2 - <code>sensor_data_evaluation</code></h2>
        </div>

        <div class="toc">
          <h4>Sommaire</h4>
          <ul>
            <li><a href="#introduction">1. Introduction et objectifs</a></li>
            <li><a href="#installation">2. Installation de ROS2 Humble</a></li>
            <li><a href="#structure">3. Structure du dossier</a></li>
            <li><a href="#illustrations">4. Illustrations clés</a></li>
            <li><a href="#fonctionnalites">5. Fonctionnalités détaillées</a></li>
            <li><a href="#code">6. Aperçu du code</a></li>
            <li><a href="#schema">7. Schéma de fonctionnement</a></li>
            <li><a href="#dashboard">8. Interface web</a></li>
            <li><a href="#serveur">9. Serveur Flask</a></li>
            <li><a href="#faq">10. FAQ & cas d'usage</a></li>
            <li><a href="#references">11. Références</a></li>
          </ul>
        </div>

        <div class="section-doc">
          <h3 id="introduction">1. Introduction et objectifs</h3>
          <p>
            Ce projet ROS2 simule un système de capteurs (température, humidité, pression) et propose une chaîne complète de génération, vérification, enregistrement et analyse de données. Il est idéal pour l'apprentissage des mécanismes de topics, nodes, paramètres dynamiques et statistiques dans ROS2.
          </p>
          <ul>
            <li>Simulation de données capteurs réalistes</li>
            <li>Vérification automatique des plages de validité</li>
            <li>Enregistrement et traçabilité des mesures</li>
            <li>Statistiques en temps réel et visualisation web</li>
          </ul>

          <div class="divider"></div>

          <h3 id="installation">2. Installation de ROS2 Humble sur Ubuntu 22.04</h3>
          <ol>
            <li><strong>Mettez à jour votre système :</strong>
              <pre><code>sudo apt update && sudo apt upgrade -y</code></pre>
            </li>
            <li><strong>Configurez la locale :</strong>
              <pre><code>sudo apt install locales
sudo locale-gen en_US en_US.UTF-8
sudo update-locale LC_ALL=en_US.UTF-8 LANG=en_US.UTF-8
export LANG=en_US.UTF-8</code></pre>
            </li>
            <li><strong>Ajoutez les sources ROS2 :</strong>
              <pre><code>sudo apt install software-properties-common
sudo add-apt-repository universe
sudo apt update && sudo apt install curl -y
sudo curl -sSL https://raw.githubusercontent.com/ros/rosdistro/master/ros.key -o /usr/share/keyrings/ros-archive-keyring.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] http://packages.ros.org/ros2/ubuntu $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/ros2.list > /dev/null</code></pre>
            </li>
            <li><strong>Installez ROS2 Humble :</strong>
              <pre><code>sudo apt update
sudo apt install ros-humble-desktop python3-argcomplete -y</code></pre>
            </li>
            <li><strong>Initialisez l'environnement :</strong>
              <pre><code>echo "source /opt/ros/humble/setup.bash" >> ~/.bashrc
source ~/.bashrc</code></pre>
            </li>
            <li><strong>Vérifiez l'installation :</strong>
              <pre><code>ros2 --version</code></pre>
            </li>
          </ol>
          <div class="tip">
            <strong>Astuce :</strong> Pour plus de détails, consultez la <a href="https://docs.ros.org/en/humble/Installation/Ubuntu-Install-Debians.html" target="_blank">documentation officielle ROS2 Humble</a>.
          </div>

          <div class="divider"></div>

          <h3 id="structure">3. Structure du dossier <code>ros</code></h3>
          <pre><code>ros/
├── dashboard_ros2.html           # Dashboard web (visualisation)
├── documentation_ros2.html       # Documentation complète
├── server.py                     # Serveur Flask pour accès aux CSV
├── logs/                         # Dossiers et fichiers de logs CSV
│   ├── sensor_data_log_*.csv     # Données brutes horodatées
│   └── sensor_stats_log.csv      # Statistiques périodiques
├── sensor_data_evaluation/       # Package ROS2 principal
│   ├── package.xml
│   ├── setup.py / setup.cfg
│   ├── launch/
│   │   └── sensor_data_launch.py # Fichier de lancement ROS2
│   ├── sensor_data_evaluation/
│   │   ├── sensor_data_publisher.py   # Node publisher
│   │   ├── sensor_data_subscriber.py  # Node subscriber
│   │   └── sensor_stats_node.py       # Node stats
│   └── test/
│       └── test_sensor_nodes.py  # Tests unitaires
├── build/                        # (auto) Fichiers de build ROS2
├── install/                      # (auto) Fichiers d'installation ROS2
└── log/                          # (auto) Logs de build ROS2
</code></pre>
          <p>Cette arborescence vous permet de repérer rapidement chaque composant du projet : scripts, dashboard, documentation, logs, tests, etc.</p>

          <div class="divider"></div>

          <h3 id="illustrations">4. Illustrations clés du projet</h3>
          <div style="display:flex; flex-wrap:wrap; gap:24px; justify-content:space-between;">
            <div style="flex:1 1 30%; min-width:220px; max-width:32%;">
              <h4>3.1 Lancement des nodes ROS2</h4>
              <div style="border:1px dashed #00f7ff; background:#0a192f; color:#aaa; text-align:center; margin:12px 0; padding:16px; border-radius:8px;"><img src="Images/publisher.png"/></div>
              <div style="border:1px dashed #00f7ff; background:#0a192f; color:#aaa; text-align:center; margin:12px 0; padding:16px; border-radius:8px;"><img src="Images/subscriber.png"/></div>
            </div>
            <div style="flex:1 1 30%; min-width:220px; max-width:32%;">
              <h4>3.2 Fichiers CSV générés</h4>
              <div style="border:1px dashed #00f7ff; background:#0a192f; color:#aaa; text-align:center; margin:12px 0; padding:16px; border-radius:8px;"><img src="Images/csv.png"/></div>
            </div>
            <div style="flex:1 1 30%; min-width:220px; max-width:32%;">
              <h4>3.3 Interface web (dashboard)</h4>
              <div style="border:1px dashed #00f7ff; background:#0a192f; color:#aaa; text-align:center; margin:12px 0; padding:16px; border-radius:8px;"><img src="Images/interfaceweb.png"/></div>
            </div>
          </div>

          <div class="divider"></div>

          <h3 id="fonctionnalites">5. Fonctionnalités détaillées</h3>
          <div style="display:flex; flex-wrap:wrap; gap:16px; justify-content:space-between;">
            <div style="flex:1 1 22%; min-width:220px; max-width:24%;">
              <h4>5.1 Génération et simulation de données</h4>
              <p>Le node <strong>publisher</strong> simule des mesures de température, humidité et pression toutes les 0,5 s. Les valeurs sont générées aléatoirement : 80 % dans la plage normale, 20 % hors plage pour tester la robustesse du système. Cela permet de reproduire un environnement de capteurs réel, avec des anomalies ponctuelles.</p>
            </div>
            <div style="flex:1 1 22%; min-width:220px; max-width:24%;">
              <h4>5.2 Vérification, log et enregistrement</h4>
              <p>Le node <strong>subscriber</strong> reçoit chaque mesure, vérifie si elle est dans la plage (paramètres dynamiques modifiables à chaud), log "Valide" ou "Hors plage", et enregistre chaque donnée dans un fichier CSV horodaté. Cela assure la traçabilité et la détection immédiate des anomalies.</p>
            </div>
            <div style="flex:1 1 22%; min-width:220px; max-width:24%;">
              <h4>5.3 Statistiques et analyse en temps réel</h4>
              <p>Le node <strong>stats</strong> calcule en continu la moyenne, le min et le max pour chaque capteur, affiche les résultats dans les logs, et sauvegarde périodiquement les statistiques dans un CSV dédié. Cela permet une analyse rapide de l'état du système et une surveillance avancée.</p>
            </div>
            <div style="flex:1 1 22%; min-width:220px; max-width:24%;">
              <h4>5.4 Visualisation web et accès distant</h4>
              <p>Le <strong>dashboard web</strong> (Chart.js) affiche en temps réel les courbes des capteurs, un tableau des dernières valeurs, et permet l'export PNG. Les données sont servies par Flask, et peuvent être consultées à distance via ngrok. L'interface est moderne, responsive et personnalisable.</p>
            </div>
          </div>

          <div class="divider"></div>

          <h3 id="code">6. Aperçu du code des nodes principaux</h3>
          <h4>6.1 Node publisher (<code>sensor_data_publisher.py</code>)</h4>
          <pre><code>import rclpy
from rclpy.node import Node
from std_msgs.msg import Float32MultiArray
import random

class SensorDataPublisher(Node):
    def __init__(self):
        super().__init__('sensor_data_publisher')
        self.publisher_ = self.create_publisher(Float32MultiArray, '/sensor_data', 10)
        self.timer = self.create_timer(0.5, self.publish_sensor_data)
        self.get_logger().info('SensorDataPublisher node started.')

    def publish_sensor_data(self):
        # 80% des cas : valeurs dans la plage normale, 20% : hors plage (±10%)
        if random.random() < 0.8:
            temperature = random.uniform(15, 35)
            humidity = random.uniform(30, 70)
            pressure = random.uniform(950, 1050)
        else:
            # Génère une valeur hors plage pour au moins un capteur
            capteur = random.choice(['temperature', 'humidity', 'pressure'])
            if capteur == 'temperature':
                temperature = random.choice([
                    random.uniform(13.5, 15),  # trop bas
                    random.uniform(35, 38.5)   # trop haut
                ])
                humidity = random.uniform(30, 70)
                pressure = random.uniform(950, 1050)
            elif capteur == 'humidity':
                temperature = random.uniform(15, 35)
                humidity = random.choice([
                    random.uniform(27, 30),    # trop bas
                    random.uniform(70, 77)     # trop haut
                ])
                pressure = random.uniform(950, 1050)
            else:
                temperature = random.uniform(15, 35)
                humidity = random.uniform(30, 70)
                pressure = random.choice([
                    random.uniform(855, 950),  # trop bas
                    random.uniform(1050, 1155) # trop haut
                ])
        msg = Float32MultiArray()
        msg.data = [temperature, humidity, pressure]
        self.publisher_.publish(msg)
        self.get_logger().info(f'Publié: Temp={temperature:.2f}°C, Hum={humidity:.2f}%, Press={pressure:.2f}hPa')

def main(args=None):
    rclpy.init(args=args)
    node = SensorDataPublisher()
    rclpy.spin(node)
    node.destroy_node()
    rclpy.shutdown()

if __name__ == '__main__':
    main()
</code></pre>
          <h4>6.2 Node subscriber (<code>sensor_data_subscriber.py</code>)</h4>
          <pre><code>import rclpy
from rclpy.node import Node
from std_msgs.msg import Float32MultiArray
import datetime
import os

class SensorDataSubscriber(Node):
    def __init__(self):
        super().__init__('sensor_data_subscriber')
        self.declare_parameter('temperature_min', 15.0)
        self.declare_parameter('temperature_max', 35.0)
        self.declare_parameter('humidity_min', 30.0)
        self.declare_parameter('humidity_max', 70.0)
        self.declare_parameter('pressure_min', 950.0)
        self.declare_parameter('pressure_max', 1050.0)
        self.subscription = self.create_subscription(
            Float32MultiArray,
            '/sensor_data',
            self.listener_callback,
            10)
        self.get_logger().info('SensorDataSubscriber node started.')
        self.current_hour = datetime.datetime.now().strftime('%Y-%m-%d_%H')
        self.filename = f'logs/sensor_data_log_{self.current_hour}.csv'
        os.makedirs('logs', exist_ok=True)
        header = 'Date,Heure,Température (°C),Humidité (%),Pression (hPa),Statut\n'
        if not os.path.exists(self.filename):
            with open(self.filename, 'w', encoding='utf-8') as f:
                f.write(header)
        self.file = open(self.filename, 'a', encoding='utf-8')

    def listener_callback(self, msg):
        # Sauvegarde périodique par heure
        now = datetime.datetime.now()
        hour_str = now.strftime('%Y-%m-%d_%H')
        if hour_str != self.current_hour:
            self.file.close()
            self.current_hour = hour_str
            self.filename = f'logs/sensor_data_log_{self.current_hour}.csv'
            header = 'Date,Heure,Température (°C),Humidité (%),Pression (hPa),Statut\n'
            self.file = open(self.filename, 'a', encoding='utf-8')
            if os.stat(self.filename).st_size == 0:
                self.file.write(header)
        temperature, humidity, pressure = msg.data
        # Paramètres dynamiques
        temp_min = self.get_parameter('temperature_min').get_parameter_value().double_value
        temp_max = self.get_parameter('temperature_max').get_parameter_value().double_value
        hum_min = self.get_parameter('humidity_min').get_parameter_value().double_value
        hum_max = self.get_parameter('humidity_max').get_parameter_value().double_value
        press_min = self.get_parameter('pressure_min').get_parameter_value().double_value
        press_max = self.get_parameter('pressure_max').get_parameter_value().double_value
        temp_ok = temp_min <= temperature <= temp_max
        hum_ok = hum_min <= humidity <= hum_max
        press_ok = press_min <= pressure <= press_max
        date_str = "'" + now.strftime('%Y-%m-%d')  # Ajoute un guillemet simple pour forcer le texte
        time_str = now.strftime('%H:%M:%S')
        statut = 'Valide' if temp_ok and hum_ok and press_ok else 'Hors plage'
        self.file.write(f'{date_str},{time_str},{temperature:.2f},{humidity:.2f},{pressure:.2f},{statut}\n')
        self.file.flush()
        if statut == 'Valide':
            self.get_logger().info(f'Valide: Temp={temperature:.2f}°C, Hum={humidity:.2f}%, Press={pressure:.2f}hPa')
</code></pre>
          <h4>6.3 Node statistiques (<code>sensor_stats_node.py</code>)</h4>
          <pre><code>import rclpy
from rclpy.node import Node
from std_msgs.msg import Float32MultiArray
import csv
import time
import os

class SensorStatsNode(Node):
    def __init__(self):
        super().__init__('sensor_stats_node')
        self.subscription = self.create_subscription(
            Float32MultiArray,
            '/sensor_data',
            self.listener_callback,
            10)
        self.count = 0
        self.temp_sum = 0.0
        self.hum_sum = 0.0
        self.press_sum = 0.0
        self.temp_min = None
        self.temp_max = None
        self.hum_min = None
        self.hum_max = None
        self.press_min = None
        self.press_max = None
        self.last_save_time = time.time()
        self.stats_filename = 'logs/sensor_stats_log.csv'
        os.makedirs('logs', exist_ok=True)
        if not os.path.exists(self.stats_filename):
            with open(self.stats_filename, 'w', encoding='utf-8', newline='') as f:
                writer = csv.writer(f)
                writer.writerow(['Timestamp', 'Nb valeurs', 'Temp Moy', 'Temp Min', 'Temp Max', 'Hum Moy', 'Hum Min', 'Hum Max', 'Press Moy', 'Press Min', 'Press Max'])
        self.get_logger().info('SensorStatsNode started.')

    def listener_callback(self, msg):
        temperature, humidity, pressure = msg.data
        self.get_logger().info(f'Reçu: Temp={temperature:.2f}°C, Hum={humidity:.2f}%, Press={pressure:.2f}hPa')
        self.count += 1
        self.temp_sum += temperature
        self.hum_sum += humidity
        self.press_sum += pressure
        self.temp_min = temperature if self.temp_min is None else min(self.temp_min, temperature)
        self.temp_max = temperature if self.temp_max is None else max(self.temp_max, temperature)
        self.hum_min = humidity if self.hum_min is None else min(self.hum_min, humidity)
        self.hum_max = humidity if self.hum_max is None else max(self.hum_max, humidity)
        self.press_min = pressure if self.press_min is None else min(self.press_min, pressure)
        self.press_max = pressure if self.press_max is None else max(self.press_max, pressure)
        self.get_logger().info(
            f"Stats (n={self.count}):\n"
            f"Température: Moy={self.temp_sum/self.count:.2f}°C, Min={self.temp_min:.2f}°C, Max={self.temp_max:.2f}°C\n"
            f"Humidité: Moy={self.hum_sum/self.count:.2f}%, Min={self.hum_min:.2f}%, Max={self.hum_max:.2f}%\n"
            f"Pression: Moy={self.press_sum/self.count:.2f}hPa, Min={self.press_min:.2f}hPa, Max={self.press_max:.2f}hPa"
        )
        self.save_stats_periodically()

    def save_stats_periodically(self):
        now = time.time()
        if now - self.last_save_time > 10:  # Sauvegarde toutes les 10 secondes
            with open(self.stats_filename, 'a', encoding='utf-8', newline='') as f:
                writer = csv.writer(f)
                writer.writerow([
                    now,
                    self.count,
                    self.temp_sum/self.count if self.count > 0 else 0,
                    self.temp_min if self.temp_min is not None else 0,
                    self.temp_max if self.temp_max is not None else 0,
                    self.hum_sum/self.count if self.count > 0 else 0,
                    self.hum_min if self.hum_min is not None else 0,
                    self.hum_max if self.hum_max is not None else 0,
                    self.press_sum/self.count if self.count > 0 else 0,
                    self.press_min if self.press_min is not None else 0,
                    self.press_max if self.press_max is not None else 0
                ])
            self.last_save_time = now
</code></pre>

          <div class="divider"></div>

          <h3 id="schema">7. Schéma de fonctionnement global</h3>
          <p><strong>Architecture :</strong></p>
          <ul>
            <li><strong>sensor_data_publisher</strong> → publie sur <code>/sensor_data</code> (topic ROS2)</li>
            <li><strong>sensor_data_subscriber</strong> ← souscrit à <code>/sensor_data</code>, vérifie, log, enregistre CSV</li>
            <li><strong>sensor_stats_node</strong> ← souscrit à <code>/sensor_data</code>, calcule stats, log, enregistre stats CSV</li>
            <li><strong>Dashboard web</strong> ← lit les CSV via <strong>Flask</strong> (API HTTP)</li>
          </ul>
          <pre><code>+-------------------+        +---------------------+
| sensor_data_      |        | sensor_data_        |
| publisher (Node)  |----->  | subscriber (Node)   |
|  (données aléa)   |        |  (vérif, log, CSV)  |
+-------------------+        +---------------------+
         |                           |
         |                           |
         |                           v
         |                 +---------------------+
         |                 | sensor_stats_node   |
         |                 | (stats, log, CSV)   |
         |                 +---------------------+
         |                           |
         v                           v
+-----------------------------------------------+
|         Fichiers CSV (logs/)                  |
+-----------------------------------------------+
         |
         v
+-------------------+
|  Flask server     |
|  (server.py)      |
+-------------------+
         |
         v
+-------------------+
| Dashboard Web     |
| (dashboard_ros2)  |
+-------------------+</code></pre>

          <div class="divider"></div>

          <h3 id="dashboard">8. Interface web (dashboard)</h3>
          <video src="Videos/dashboard.webm" autoplay muted loop playsinline  type = video/mp4></video>
          <ul>
            <li>Visualisation en temps réel des 3 capteurs (graphiques Chart.js dynamiques)</li>
            <li>Tableau des 10 dernières valeurs reçues</li>
            <li>Bouton d'export PNG des graphiques</li>
            <li>Mise à jour automatique toutes les 2 s (AJAX)</li>
            <li>Style moderne conforme à la charte UCAO-TECH (bleu, violet, sombre, police Orbitron/Roboto)</li>
            <li>Facilement personnalisable (CSS, logo, couleurs)</li>
          </ul>
          <div class="tip">
            <strong>Astuce :</strong> Pour adapter le style, modifiez les couleurs ou ajoutez votre logo dans le fichier <code>dashboard_ros2.html</code>.
          </div>

          <div class="divider"></div>

          <h3 id="serveur">9. Serveur Flask & accès distant (ngrok)</h3>
          <ul>
            <li>Le serveur <code>server.py</code> expose les CSV via HTTP (API REST simple)</li>
            <li>Permet au dashboard d'accéder aux données même à distance</li>
            <li>Pour ouvrir l'accès à Internet : <code>ngrok http 5000</code> (nécessite <a href="https://ngrok.com/" target="_blank">ngrok</a>)</li>
            <li>URL publique générée par ngrok à partager pour consultation externe</li>
            <li><strong>Sécurité :</strong> Pour un usage public, ajoutez une authentification ou limitez l'accès par IP</li>
          </ul>
          <div class="warn">
            <strong>Conseil sécurité :</strong> Ne laissez pas un tunnel ngrok ouvert sans surveillance sur un réseau public.
          </div>

          <div class="divider"></div>

          <h3 id="faq">10. FAQ & cas d'usage</h3>
          <ul>
            <li><strong>Q : Puis-je ajouter d'autres capteurs ?</strong><br>A : Oui, modifiez le publisher et adaptez le message/CSV.</li>
            <li><strong>Q : Comment changer les plages de validité ?</strong><br>A : Utilisez <code>ros2 param set</code> sur le node subscriber.</li>
            <li><strong>Q : Peut-on visualiser l'historique complet ?</strong><br>A : Oui, ouvrez le CSV dans Excel ou développez une page web dédiée.</li>
            <li><strong>Q : Comment exporter les données ?</strong><br>A : Utilisez l'export PNG du dashboard ou téléchargez le CSV via Flask.</li>
          </ul>
          <h4>10.1 Cas d'usage</h4>
          <ul>
            <li>Démo pédagogique ROS2 (université, formation, MOOC)</li>
            <li>Tests de robustesse d'algorithmes de monitoring</li>
            <li>Prototype de supervision IoT/industrielle</li>
            <li>Base pour projet d'analyse prédictive ou IA</li>
          </ul>

          <div class="divider"></div>

          <h3 id="references">11. Références</h3>
          <ul>
            <li><a href="https://docs.ros.org/en/humble/index.html" target="_blank">Documentation ROS2 Humble</a></li>
            <li><a href="https://docs.ros.org/en/humble/Tutorials.html" target="_blank">Tutoriels ROS2 Python</a></li>
          </ul>
        </div>
      </div>
    </section>
  </main>
</body>
</html>
